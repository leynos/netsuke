netsuke_version: "1.0"

vars:
  pages_dir: pages
  site_dir: site


rules:
  - name: page
    command: "pandoc {ins} -o {outs}"

  - name: index
    script: |
      cat {{ site_dir }}/*.html > {{ site_dir }}/index.html

targets:
  - foreach: "{{ glob(pages_dir ~ '/*.md') }}"
    name: "{{ site_dir }}/{{ item | basename | replace('.md', '.html') }}"
    rule: page
    sources: "{{ item }}"

  - name: "{{ site_dir }}/index.html"
    rule: index
    deps: "{{ glob(site_dir ~ '/*.html') }}"
    always: true

defaults:
  - "{{ site_dir }}/index.html"
